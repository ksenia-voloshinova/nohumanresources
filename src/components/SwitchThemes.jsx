"use client"
import React, {useEffect, useState} from 'react';
import styles from "../styles/SwitchThemes.module.scss"
import { useCookies,withCookies, Cookies } from "react-cookie"
import {use} from "i18next";

const SwitchThemes = () => {
    const [useDarkScheme, setUseDarkScheme] = useState(false);
    const [cookie, setCookie] = useCookies(["darkTheme"])

    const handleToggle = () => {
        switchDarkScheme(!useDarkScheme);

        setCookie(
            "darkTheme",
            JSON.stringify(!useDarkScheme),
            {
                path: "/",
                maxAge: 3600 * 8, // Expires after 1hr
                sameSite: true,
            }
        )

        setUseDarkScheme(!useDarkScheme);
    };

    useEffect(() => {
        let useDarkScheme = new Cookies().get('darkTheme')

        if (useDarkScheme === undefined){
            const useDarkScheme = window?.matchMedia?.('(prefers-color-scheme: dark)')?.matches ?? false;

            setCookie(
                "darkTheme",
                JSON.stringify(useDarkScheme),
                {
                    path: "/",
                    maxAge: 3600 * 8, // Expires after 1hr
                    sameSite: true,
                }
            )
        }

        setUseDarkScheme(useDarkScheme);
        switchDarkScheme(useDarkScheme);
    }, []);


    return (
        <div className={styles.wrapp__switch}>
            <input
                checked={useDarkScheme}
                onChange={handleToggle}
                className={styles.switchCheckbox}
                id={`react-switch-new-theme`}
                type="checkbox"
            />
            <label
                className={styles.switchLabel}
                htmlFor={`react-switch-new-theme`}
            >
                <svg xmlns="http://www.w3.org/2000/svg" width="27" height="28" viewBox="0 0 27 28" fill="none">
                    <path d="M13.5013 6.78299C17.2323 6.78299 20.2655 9.80198 20.2726 13.5259C20.2798 17.2711 17.2465 20.2972 13.4942 20.2901C9.76314 20.283 6.74415 17.264 6.74415 13.533C6.73703 9.8091 9.77026 6.78299 13.5013 6.78299Z" fill="white"/>
                    <path d="M14.8954 2.04801C14.8669 2.37554 14.8812 2.71731 14.81 3.03061C14.6391 3.72839 14.0552 4.12712 13.3646 4.06304C12.7024 3.99896 12.1755 3.45782 12.1399 2.76004C12.1185 2.27586 12.1114 1.79168 12.1399 1.3075C12.1755 0.574118 12.7878 -0.00262263 13.4927 -0.00262263C14.2119 -0.00974288 14.8242 0.588358 14.8669 1.33599C14.8812 1.57095 14.8669 1.80592 14.8669 2.04089C14.8812 2.04801 14.8883 2.04801 14.8954 2.04801Z" fill="white"/>
                    <path d="M14.8894 25.0464C14.8681 25.3597 14.8823 25.6872 14.8111 25.9934C14.6545 26.6841 14.0208 27.1398 13.3871 27.0615C12.6964 26.9831 12.1695 26.4349 12.141 25.73C12.1197 25.26 12.1197 24.7901 12.141 24.3202C12.1766 23.5512 12.7676 22.9958 13.5152 23.0029C14.2629 23.01 14.8396 23.5725 14.8681 24.3415C14.8752 24.5765 14.8681 24.8114 14.8681 25.0464C14.8752 25.0464 14.8823 25.0464 14.8894 25.0464Z" fill="white"/>
                    <path d="M5.88761 7.23155C5.87337 7.23155 5.85913 7.23155 5.84489 7.23155C5.02606 7.22443 3.56641 5.7719 3.56641 4.94595C3.56641 4.36209 3.83698 3.94199 4.36387 3.69278C4.87653 3.45781 5.37495 3.5219 5.79505 3.89215C6.18666 4.24104 6.55691 4.61842 6.9058 5.01003C7.2903 5.44437 7.34726 5.95702 7.09093 6.4768C6.84172 6.97522 6.43587 7.23155 5.88761 7.23155Z" fill="white"/>
                    <path d="M21.1622 7.28852C20.5712 7.23868 20.1583 6.97523 19.9162 6.46969C19.6741 5.96415 19.7239 5.45862 20.0942 5.03852C20.4502 4.63267 20.8276 4.24817 21.2334 3.89216C21.739 3.44358 22.5222 3.47207 23.0135 3.93488C23.5119 4.3977 23.6258 5.17381 23.1986 5.70071C22.807 6.17776 22.3513 6.6121 21.8814 7.01083C21.6962 7.16748 21.4043 7.20308 21.1622 7.28852Z" fill="white"/>
                    <path d="M5.83041 19.7775C6.42139 19.8273 6.83437 20.0836 7.08357 20.5892C7.3399 21.109 7.27582 21.6216 6.89133 22.0559C6.54244 22.4476 6.17218 22.8249 5.78057 23.1738C5.27503 23.6295 4.49892 23.601 4.0005 23.1453C3.50209 22.6897 3.37392 21.9064 3.80114 21.3795C4.18563 20.9025 4.64845 20.4681 5.11126 20.0623C5.29639 19.9056 5.58832 19.87 5.83041 19.7775Z" fill="white"/>
                    <path d="M20.8485 19.8344C21.9451 19.8273 23.4189 21.2513 23.4403 22.0773C23.4545 22.654 23.1626 23.1382 22.6428 23.3661C22.1088 23.601 21.6104 23.5227 21.1832 23.1382C20.8129 22.8036 20.464 22.4475 20.1294 22.0773C19.7449 21.6501 19.6595 21.1374 19.9087 20.6176C20.1436 20.1121 20.5566 19.8415 20.8485 19.8344Z" fill="white"/>
                    <path d="M2.04351 14.8787C1.7943 14.8787 1.54509 14.8858 1.29589 14.8787C0.5625 14.8502 0 14.2735 0 13.5401C0 12.8067 0.55538 12.2229 1.29589 12.2015C1.7943 12.1873 2.29272 12.1873 2.79114 12.2015C3.51028 12.2229 4.09415 12.8495 4.07278 13.5615C4.05854 14.2664 3.48892 14.8502 2.78402 14.8787C2.54193 14.8858 2.29272 14.8787 2.04351 14.8787Z" fill="white"/>
                    <path d="M24.9573 14.8787C24.7223 14.8787 24.4873 14.8859 24.2524 14.8787C23.519 14.8574 22.9422 14.2735 22.928 13.5544C22.9137 12.8281 23.5047 12.2158 24.2595 12.1944C24.7436 12.1802 25.2278 12.1802 25.712 12.1944C26.4454 12.2158 27.0008 12.8067 27.0008 13.5401C27.0008 14.2735 26.4454 14.8574 25.7049 14.8787C25.4557 14.8859 25.2065 14.8787 24.9573 14.8787Z" fill="white"/>
                </svg>
                <span className={styles.switchButton}/>
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="24" viewBox="0 0 25 24" fill="none">
                    <path d="M8.76933 0.0382385C5.6798 5.52373 7.47677 11.4317 10.8626 14.6032C14.4188 17.9323 20.0367 18.9726 24.8664 16.211C24.7529 17.4027 22.5587 20.2715 20.7113 21.6208C18.7882 23.0206 16.6382 23.8213 14.2674 23.9726C7.69114 24.3951 2.36959 19.8743 1.22205 14.0042C-0.0137655 7.71793 3.59909 2.07481 8.76933 0.0382385Z" fill="white"/>
                    <path d="M21.9418 9.47061C21.7275 9.01034 21.5131 8.55006 21.2924 8.08348C21.1222 7.71778 20.8573 7.44666 20.4916 7.27011C20.0188 7.04313 19.5522 6.81614 19.0352 6.56393C19.4954 6.34325 19.9053 6.12888 20.3277 5.95233C20.8321 5.73796 21.1663 5.39117 21.3807 4.88676C21.5509 4.47062 21.759 4.07339 21.9734 3.60681C22.1751 4.03556 22.3706 4.40757 22.5219 4.79218C22.7615 5.39748 23.1776 5.80101 23.7766 6.0343C24.1549 6.18562 24.5206 6.36847 24.8737 6.53241C24.2495 6.8855 23.5181 7.1314 23.0326 7.6169C22.5471 8.1087 22.3012 8.8401 21.9418 9.47061Z" fill="white"/>
                    <path d="M12.6721 11.1036C12.4893 10.719 12.3001 10.3344 12.1299 9.94349C11.9975 9.63454 11.7957 9.42647 11.4805 9.30037C11.0958 9.14274 10.7301 8.95358 10.3203 8.72029C11.5687 8.39873 12.3506 7.6295 12.6154 6.34955C12.6532 6.36846 12.6847 6.38738 12.7226 6.39999C12.8361 6.6522 12.9811 6.89179 13.0631 7.15661C13.2396 7.76191 13.6431 8.13391 14.2106 8.3609C14.4817 8.46808 14.7465 8.58788 15.0429 8.72029C14.5069 9.01663 13.9206 9.21209 13.5296 9.60301C13.1513 9.98132 12.9622 10.574 12.6721 11.1036Z" fill="white"/>
                    <path d="M17.8814 11.5324C18.1399 12.3773 18.6507 12.9259 19.5334 13.115C19.1298 13.342 18.7452 13.4744 18.4804 13.7329C18.2282 13.9851 18.1021 14.3697 17.8751 14.767C17.6544 13.9095 17.1437 13.3924 16.2988 13.1591C17.1311 12.9132 17.6797 12.4214 17.8814 11.5324Z" fill="white"/>
                    <path d="M16.6119 0.000244141C16.8767 0.838831 17.3685 1.39369 18.2386 1.60806C17.4 1.87288 16.8515 2.36468 16.6434 3.22849C16.3912 2.3836 15.8805 1.85396 15.0293 1.62067C15.8679 1.38108 16.4038 0.876662 16.6119 0.000244141Z" fill="white"/>
                </svg>
            </label>
        </div>
    );
};

function switchDarkScheme(useDarkScheme) {
    const body = document.body

    switch (useDarkScheme){
        case true:
            body.classList.add("dark")
            break;
        case false:
            body.classList.remove("dark")
            break;
    }
}
export default SwitchThemes;